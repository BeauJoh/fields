<!doctype s-function-doc system "s-function-doc.dtd" [
<!entity % S-OLD "INCLUDE">
]
>
<s-function-doc>
<s-topics>
<s-topic> vgram </s-topic>
</s-topics>
<s-title>
Finds a traditional or robust variogram for spatial data. 
</s-title>
<s-description>
Computes pairwise squared differences as a function of distance. 
Returns either raw values or statistics from binning. 
</s-description>
<s-usage>
<s-old-style-usage>
vgram(loc, y, id=NULL, d=NULL, lon.lat=F, dmax=NULL, N=NULL, breaks=NULL)
</s-old-style-usage>
</s-usage>
<s-args-required>
<s-arg name= loc >
Matrix where each row is the coordinates of an observed point
of the field
</s-arg>
<s-arg name= y >
Value of the field at locations
</s-arg>
</s-args-required>
<s-args-optional>
<s-arg name= id >
A 2 column matrix that specifies which variogram differnces to find. 
If omitted all possible pairing are found. 
This can can used if the data has an additional covariate that determines
proximity, for example a time window. 
</s-arg>
<s-arg name= d >
Distances among pairs indexed by id. If not included distances from from
directly from loc. 
</s-arg>
<s-arg name= lon.lat >
If true, locations are assumed to be longitudes and latitudes
and 
distances found are great circle distances ( in miles see rdist.earth).
Default is false. 
</s-arg>
<s-arg name= dmax >
Maximum distance to compute variogram.
</s-arg>
<s-arg name= N >
Number of bins to use.
</s-arg>
<s-arg name= breaks >
Bin boundaries for binning variogram values. Need not be equally spaced
but must be ordered. 
</s-arg>
</s-args-optional>
<s-value>
<s-return-component name= vgram>
variogram values 
</s-return-component >
<s-return-component name= vgram>
variogram values 
</s-return-component >
<s-return-component name= d>
pairwise distances 
</s-return-component >
<s-return-component name= call>
calling string 
</s-return-component >
<s-return-component name= stats>
Matrix of statistics for values in each bin. 
Rows are the summaries returned by the stats function or describe.  
If not either breaks or N arguments are not supplied then this
component is not computed. 
</s-return-component >
<s-return-component name= centers>
Bin centers
</s-return-component >
</s-value>
<s-section name = "REFERENCES">
See any standard reference on spatial statistics. For example 
Cressie, Spatial Statistics  
</s-section>
<s-see>
vgram.matrix
bplot.xy, vgram.matrix 
</s-see>
<s-examples>
<s-example>

#
# compute variogram for the midwest ozone field  day 16
# (BTW this looks a bit strange!)
#
data( ozone2)
good<- !is.na(ozone2$y[16,])
x<- ozone2$lon.lat[good,] 
y<- ozone2$y[16,good]

look<-vgram( x,y, N=15, lon.lat=T) # locations are in lon/lat so use right
#distance
plot( look$d, look$vgram)
lines(look$centers, look$stats["mean",], col=4)

brk<- seq( 0, 250,,25)
 
## or 
par( pch=".")
bplot.xy( look$d, sqrt(look$vgram), breaks=brk,ylab="sqrt(VG)")
</s-example>
</s-examples>
<s-keywords>
<s-keyword>spatial</s-keyword>
</s-keywords>
<s-docclass>
function
</s-docclass>
</s-function-doc>
